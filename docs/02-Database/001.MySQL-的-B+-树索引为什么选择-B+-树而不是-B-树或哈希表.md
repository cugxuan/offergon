---
title: MySQL 的 B+ 树索引为什么选择 B+ 树而不是 B 树或哈希表？
tags:
  - 数据库
  - 索引
status: robot
class: 数据库
slug: b-plus-tree-index-vs-b-tree-hash
ref:
---

## 核心要点

**选择 B+ 树的核心原因：磁盘 I/O 优化 + 范围查询高效 + 有序性支持**

## 详细回答

### 一、B+ 树相比 B 树的优势

**1. 磁盘 I/O 更少**
- B+ 树的非叶子节点只存储键值，不存储数据，单个节点可以容纳更多索引项
- 这使得 B+ 树的高度更低，查询时需要的磁盘 I/O 次数更少
- 例如：InnoDB 默认页大小 16KB，B+ 树高度 3-4 层就能存储千万级数据

**2. 范围查询性能优异**
- B+ 树的叶子节点通过双向链表连接，范围查询只需遍历链表即可
- B 树范围查询需要重复进行中序遍历，效率低下
- 示例：`SELECT * FROM user WHERE age BETWEEN 20 AND 30`，B+ 树定位到 20 后直接顺序扫描链表

**3. 查询性能稳定**
- B+ 树所有数据都在叶子节点，任何查询都需要从根到叶子，时间复杂度稳定为 O(log n)
- B 树数据分布在所有节点，查询时间不稳定

**4. 全表扫描效率高**
- B+ 树只需遍历叶子节点链表即可完成全表扫描
- B 树需要遍历整棵树

### 二、B+ 树相比哈希表的优势

**1. 支持范围查询**
- 哈希表只支持等值查询（=、IN），不支持范围查询（>、<、BETWEEN）
- B+ 树天然支持有序存储，范围查询效率高

**2. 支持排序和分组**
- B+ 树有序性支持 ORDER BY、GROUP BY 等操作
- 哈希表无序，需要额外排序

**3. 支持最左前缀匹配**
- B+ 树支持 LIKE 'abc%' 的前缀查询
- 哈希表无法支持模糊匹配

**4. 无哈希冲突**
- 哈希表存在哈希冲突，性能可能退化
- B+ 树性能稳定

**5. 适合磁盘存储**
- B+ 树的节点大小可以设计为磁盘页的整数倍，减少磁盘 I/O
- 哈希表更适合内存场景（如 Redis）

### 三、实际应用场景

| 索引类型 | 适用场景 | MySQL 引擎 |
|---------|---------|-----------|
| B+ 树   | 主键、唯一索引、普通索引、联合索引 | InnoDB、MyISAM（默认） |
| 哈希    | Memory 引擎的等值查询场景 | Memory（HEAP） |
| 全文索引 | 文本搜索 | InnoDB（5.6+）、MyISAM |

### 四、面试加分项

**InnoDB 自适应哈希索引**：
- InnoDB 会自动监控索引使用情况，对热点数据页自动创建哈希索引（存储在内存）
- 这是 B+ 树与哈希优势的结合：磁盘用 B+ 树保证通用性，内存用哈希提升热点数据性能
